build:
  stage: build
  image: mcr.microsoft.com/dotnet/sdk:7.0-alpine
  variables:
    NUGET_PACKAGES: $CI_PROJECT_DIR/.nuget
  artifacts:
    paths:
      - artifacts/*.nupkg
      - src/**/*.binlog
    expire_in: 42s

  cache:
    paths:
      - .nuget/
  script:
    - apk update && apk add nodejs-current npm
    - dotnet restore Helveg.sln
    - dotnet build -c Release Helveg.sln -m:1
    - dotnet pack --no-build src/CommandLine -o artifacts -c Release -bl
