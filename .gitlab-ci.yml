build:
  stage: build
  image: mcr.microsoft.com/dotnet/sdk:7.0-alpine
  variables:
    NUGET_PACKAGES: $CI_PROJECT_DIR/.nuget
  artifacts:
    paths:
      - artifacts/*.nupkg
      - "**/*.binlog"
    expire_in: 42s
    when: always
  cache:
    paths:
      - .nuget/
  script:
    - apk update && apk add nodejs-current npm
    - dotnet restore Helveg.sln
    - dotnet build -bl -c Release Helveg.sln
    - dotnet pack --no-build src/CommandLine -o artifacts -c Release
